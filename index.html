<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Buon Anno Amore! ğŸ’–ğŸ†</title>

  <style>
    :root { --bg1:#0b1026; --bg2:#2a0b3f; --card: rgba(255,255,255,.10); --txt: #fff; }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; color:var(--txt);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1000px 800px at 20% 20%, #ff4fd8 0%, transparent 50%),
                  radial-gradient(900px 700px at 80% 30%, #4df3ff 0%, transparent 55%),
                  linear-gradient(135deg,var(--bg1),var(--bg2));
      overflow:hidden;
    }
    .wrap{
      min-height:100vh;
      display:grid;
      place-items:center;
      padding:24px;
      position:relative;
      z-index:5; /* sopra fuochi/coriandoli */
    }
    .card{
      width:min(720px, 92vw);
      background: var(--card);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 24px;
      padding: 22px 18px;
      backdrop-filter: blur(10px);
      box-shadow: 0 18px 60px rgba(0,0,0,.35);
      text-align:center;
    }
    h1{
      margin: 0 0 10px;
      font-size: clamp(28px, 5vw, 44px);
      line-height:1.05;
      letter-spacing: .3px;
      text-shadow: 0 6px 18px rgba(0,0,0,.25);
    }
    .sub{
      margin: 0 0 16px;
      font-size: clamp(16px, 2.6vw, 20px);
      opacity:.95;
    }
    .emoji-wall{
      display:flex; flex-wrap:wrap; justify-content:center;
      gap: 8px;
      padding: 14px 10px;
      border-radius: 18px;
      background: rgba(255,255,255,.08);
      border: 1px dashed rgba(255,255,255,.22);
      margin: 12px 0 18px;
      user-select:none;
    }
    .e{
      font-size: 26px;
      filter: drop-shadow(0 4px 8px rgba(0,0,0,.25));
      animation: pop 1.2s ease-in-out infinite;
    }
    .e:nth-child(3n){ animation-delay:.15s }
    .e:nth-child(4n){ animation-delay:.28s }
    .e:nth-child(5n){ animation-delay:.37s }
    @keyframes pop{
      0%,100%{ transform: translateY(0) rotate(0deg) scale(1); }
      50%{ transform: translateY(-6px) rotate(6deg) scale(1.08); }
    }

    .msg{
      font-size: clamp(16px, 2.7vw, 20px);
      line-height:1.35;
      margin: 0 0 16px;
    }

    .btns{
      display:flex; flex-wrap:wrap; gap:12px;
      justify-content:center;
      margin-top: 10px;
    }
    .btn{
      appearance:none; border:0; cursor:pointer;
      padding: 12px 16px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 16px;
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition: transform .08s ease, filter .15s ease;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    .btn:active{ transform: scale(.98) }
    .wa{
      background: linear-gradient(135deg, #25D366, #128C7E);
      color:#062b1c;
    }
    .spark{
      background: linear-gradient(135deg, #ffd36b, #ff4fd8);
      color:#2c0a26;
    }

    /* coriandoli */
    .confetti{
      position:fixed;
      inset:0;
      overflow:hidden;
      pointer-events:none;
      z-index:2;
    }
    .c{
      position:absolute;
      top:-12px;
      width:10px; height:14px;
      opacity:.95;
      transform: rotate(25deg);
      animation: fall linear infinite;
      border-radius:2px;
    }
    @keyframes fall{
      to{ transform: translateY(110vh) rotate(720deg); }
    }

    /* fuochi */
    #fireworks{
      position:fixed;
      inset:0;
      z-index:4;          /* davanti ai coriandoli, dietro la card */
      pointer-events:none; /* non blocca click */
    }

    .tiny{
      opacity:.85;
      font-size: 13px;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <!-- coriandoli -->
  <div class="confetti" id="confetti"></div>

  <!-- fuochi d'artificio -->
  <canvas id="fireworks"></canvas>

  <div class="wrap">
    <div class="card">
      <h1>Buon Anno amore! ğŸ’–ğŸ†</h1>
      <p class="sub">Attenzione: contiene una quantitÃ  illegale di faccine ğŸ˜„ğŸš¨ğŸ’–</p>

      <div class="emoji-wall" id="wall" aria-label="emoji wall"></div>

      <p class="msg" id="msg">
        Sei la mia parte preferita di ogni annoâ€¦ e di ogni giorno. ğŸ¥°<br/>
        Facciamo un anno pieno di risate, baci rubati e abbracci lunghi. ğŸ’‹ğŸ¤<br/>
        (E io rivendico ufficialmente il diritto a rubarti un bacio extra ogni giorno ğŸ˜œğŸ’˜)
      </p>

      <div class="btns">
        <a class="btn wa" id="waBtn" target="_blank" rel="noopener">
          ğŸ’¬ Mandaglielo su WhatsApp
        </a>
        <button class="btn spark" id="moreBtn" type="button">
          ğŸ‡ PiÃ¹ emoji!
        </button>
      </div>

      <div class="tiny">
        P.S. Se vuoi cambiare il testo WhatsApp, cerca <b>TESTO_WA</b> nel file ğŸ˜‰
      </div>
    </div>
  </div>

  <script>
    // --- Emoji wall ---
    const emojis = ["ğŸ¥°","ğŸ˜","ğŸ˜˜","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ’‹","ğŸ†","ğŸ‡","âœ¨","ğŸ¥‚","ğŸ¾","ğŸ˜„","ğŸ˜‚","ğŸ˜œ","ğŸ¤","ğŸŒ™","â­","ğŸ«¶","ğŸŒ¹","ğŸ‰","ğŸ’«","ğŸ§¸","ğŸ“","ğŸ«","ğŸ»","ğŸ˜»","ğŸ¤­","ğŸ˜‡","ğŸ’Œ","ğŸª©","ğŸŠ"];
    const wall = document.getElementById("wall");

    function fillWall(count=72){
      wall.innerHTML = "";
      for(let i=0;i<count;i++){
        const span = document.createElement("span");
        span.className = "e";
        span.textContent = emojis[Math.floor(Math.random()*emojis.length)];
        wall.appendChild(span);
      }
    }
    fillWall(84);

    // --- WhatsApp link (TESTO_WA) ---
    const testoWA = "â¤ï¸ğŸ† Buon Anno amore mio! Sei la mia parte preferita di ogni annoâ€¦ e di ogni giorno. " +
                    "Questo nuovo anno lo voglio pieno di risate, abbracci lunghi e baci rubati (sÃ¬, anche extra ğŸ˜œğŸ’‹). " +
                    "Ti amo ğŸ’–ğŸ¥‚âœ¨";
    const waLink = "https://api.whatsapp.com/send?text=" + encodeURIComponent(testoWA);
    document.getElementById("waBtn").href = waLink;

    // --- Confetti ---
    const confetti = document.getElementById("confetti");
    function makeConfetti(n=110){
      confetti.innerHTML = "";
      for(let i=0;i<n;i++){
        const d = document.createElement("div");
        d.className = "c";
        d.style.left = Math.random()*100 + "vw";
        d.style.animationDuration = (3 + Math.random()*4) + "s";
        d.style.animationDelay = (Math.random()*2) + "s";
        d.style.background = `hsl(${Math.floor(Math.random()*360)}, 95%, 65%)`;
        d.style.width = (6 + Math.random()*10) + "px";
        d.style.height = (8 + Math.random()*14) + "px";
        d.style.opacity = (0.55 + Math.random()*0.45);
        confetti.appendChild(d);
      }
    }
    makeConfetti(140);

    // --- Button: more emojis + confetti burst ---
    document.getElementById("moreBtn").addEventListener("click", () => {
      fillWall(110);
      makeConfetti(220);
      setTimeout(()=>makeConfetti(140), 900);
      burstFireworks(4); // boom extra
    });

    // =========================
    //      FIREWORKS ğŸ†
    // =========================
    const canvas = document.getElementById("fireworks");
    const ctx = canvas.getContext("2d");
    let w, h;
    function resize() {
      w = canvas.width = window.innerWidth;
      h = canvas.height = window.innerHeight;
    }
    resize();
    window.addEventListener("resize", resize);

    const fireworks = [];
    const particles = [];

    function random(min, max) { return Math.random() * (max - min) + min; }

    class Firework {
      constructor(x, y) {
        this.x = x;
        this.y = h + 10;
        this.targetY = y;
        this.speed = random(5, 9);
        this.exploded = false;
      }
      update() {
        this.y -= this.speed;
        if (this.y <= this.targetY && !this.exploded) {
          this.exploded = true;
          explode(this.x, this.y);
        }
      }
      draw() {
        ctx.fillStyle = "rgba(255,255,255,0.9)";
        ctx.fillRect(this.x, this.y, 2, 10);
      }
    }

    function explode(x, y) {
      const count = 42;
      for (let i = 0; i < count; i++) {
        particles.push({
          x, y,
          angle: Math.random() * Math.PI * 2,
          speed: random(2.2, 6.8),
          life: 70,
          color: `hsl(${Math.random() * 360}, 100%, 62%)`
        });
      }
    }

    function updateParticles() {
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.x += Math.cos(p.angle) * p.speed;
        p.y += Math.sin(p.angle) * p.speed;
        p.speed *= 0.98;       // rallenta
        p.life--;
        if (p.life <= 0) particles.splice(i, 1);
      }
    }

    function drawParticles() {
      particles.forEach(p => {
        ctx.fillStyle = p.color;
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fill();
      });
    }

    function loop() {
      ctx.clearRect(0, 0, w, h);

      for (let i = fireworks.length - 1; i >= 0; i--) {
        const f = fireworks[i];
        f.update();
        f.draw();
        if (f.exploded) fireworks.splice(i, 1);
      }

      updateParticles();
      drawParticles();

      requestAnimationFrame(loop);
    }

    function launchRandom() {
      fireworks.push(new Firework(random(40, w - 40), random(110, h * 0.55)));
    }

    function burstFireworks(n=3) {
      for (let i=0;i<n;i++){
        setTimeout(launchRandom, i * 120);
      }
    }

    // Fuochi automatici (sparo continuo)
    setInterval(launchRandom, 750);

    // Extra boom quando tocchi la pagina (anche da telefono)
    window.addEventListener("pointerdown", (e) => {
      const x = e.clientX ?? (w/2);
      const y = e.clientY ?? (h/2);
      fireworks.push(new Firework(x, y));
      burstFireworks(2);
    });

    loop();
  </script>
</body>
</html>
